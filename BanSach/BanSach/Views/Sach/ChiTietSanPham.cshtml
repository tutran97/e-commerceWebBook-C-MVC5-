@model BanSach.Models.SachDetail
@using PagedList.Mvc;
@{
    BUS.SachBUS sachBus = new BUS.SachBUS();
    BUS.ChuDeBUS chudeBus = new BUS.ChuDeBUS();
    BUS.NhaXuatBanBUS nxbBus = new BUS.NhaXuatBanBUS();
    BUS.TacGiaBUS tacgiaBus = new BUS.TacGiaBUS();
    var list = new BUS.ChuDeBUS().ListByChuDeId(sachBus.LaySach(Model.MaSach).MaChuDe,  " ");//danh muc khoi tao nhiu ham()
    var model = new List<BanSach.Models.SachDetail>();
    foreach (var sach in list)
    {
        model.Add(new BanSach.Models.SachDetail()
        {
            MaSach = sach.MaSach,
            TenSach = sach.TenSach,
            AnhBia = sach.AnhBia,
            ChuDe = chudeBus.LayChuDe(sach.MaChuDe).TenChuDe,
            GiaBan = sach.GiaBan,
            SoLuongTon = sach.SoLuongTon,
            MoTa = sach.MoTa,
            NgayCapNhat = sach.NgayCapNhat,
            NhaXuatBan = nxbBus.LayNXB(sach.MaNXB).TenNXB,
            TacGia = tacgiaBus.LayTG(sach.MaTacGia).TenTacGia,
            TrangThai=sach.TrangThai

        });
    }
    ViewBag.Title = "ChiTietSanPham";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<div class="container">
    <div style="height: 520px;" class="row">
        <div class="col-md-3">

            <script src="~/Content/NguoDungCssLayout/app/services/moduleServices.js"></script>
            <script src="~/Content/NguoDungCssLayout/app/controllers/moduleController.js"></script>
            <!--thong tin web Trai-->
            <div class="box-sale-policy ng-scope" ng-controller="moduleController" ng-init="initSalePolicyController('Shop')">
                <h3><span>Chính sách bán hàng</span></h3>
                <div class="sale-policy-block">
                    <ul>
                        <li>Giao hàng TOÀN QUỐC</li>
                        <li>Thanh toán khi nhận hàng</li>
                        <li>Đổi trả trong <span> 3ngày</span></li>
                        <li>Hoàn ngay tiền mặt</li>
                        <li>Chất lượng đảm bảo</li>
                        <li>Miễn phí vận chuyển:<span>Đơn hàng từ 3 món trở lên</span></li>
                    </ul>
                </div>
                <div class="buy-guide">
                    <h3>Hướng Dẫn Mua Hàng</h3>
                    <ul>
                        <li>
                            Mua hàng trực tiếp tại website
                            <b class="ng-binding"> http://www.sach.vn</b>
                        </li>
                        <li>
                            Gọi điện thoại <strong class="ng-binding">
                                0961.421 396
                            </strong> để mua hàng
                        </li>
                        <li>
                            Mua tại Trung tâm CSKH:<br>
                            <strong class="ng-binding">65 Đường Huỳnh Thúc Kháng, Bến Nghé, Quận 1, Hồ Chí Minh</strong>
                            <a href="/home/lienhe" rel="nofollow" target="_blank">Xem Bản Đồ</a>
                        </li>
                        <li>
                            Mua sỉ/buôn xin gọi <strong class="ng-binding">
                                0961.421 396
                            </strong> để được
                            hỗ trợ.
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <!--END-->


        <div style="    height: 519px;" class="col-md-9">


            <script type="text/javascript">
                $(".link-site-more").hover(function () { $(this).find(".s-c-n").show(); }, function () { $(this).find(".s-c-n").hide(); });
            </script>

            <link href="~/Content/NguoDungCssLayout/Scripts/smoothproducts/smoothproducts.css" rel="stylesheet" type="text/css">
            <script src="~/Content/NguoDungCssLayout/Scripts/smoothproducts/smoothproducts.js" type="text/javascript"></script>
            <script src="~/Content/NguoDungCssLayout/app/services/productServices.js"></script>
            <script src="~/Content/NguoDungCssLayout/app/controllers/productController.js"></script>
            <div class="product-detail clearfix relative ng-scope" ng-controller="productController" ng-init="initController(9519)">
                <span us-spinner="{radius:5, width:3, length: 3}" class="ng-scope ng-hide"><div class="spinner" role="progressbar" style="position: absolute; width: 0px; z-index: 2000000000; left: 50%; top: 50%;"><div style="position: absolute; top: -1px; opacity: 0.25; animation: 1s linear 0s infinite normal none running opacity-100-25-0-12;"><div style="position: absolute; width: 6px; height: 3px; background: rgb(0, 0, 0); box-shadow: rgba(0, 0, 0, 0.1) 0px 0px 1px; transform-origin: left center; transform: rotate(0deg) translate(5px, 0px); border-radius: 1px;"></div></div><div style="position: absolute; top: -1px; opacity: 0.25; animation: 1s linear 0s infinite normal none running opacity-100-25-1-12;"><div style="position: absolute; width: 6px; height: 3px; background: rgb(0, 0, 0); box-shadow: rgba(0, 0, 0, 0.1) 0px 0px 1px; transform-origin: left center; transform: rotate(30deg) translate(5px, 0px); border-radius: 1px;"></div></div><div style="position: absolute; top: -1px; opacity: 0.25; animation: 1s linear 0s infinite normal none running opacity-100-25-2-12;"><div style="position: absolute; width: 6px; height: 3px; background: rgb(0, 0, 0); box-shadow: rgba(0, 0, 0, 0.1) 0px 0px 1px; transform-origin: left center; transform: rotate(60deg) translate(5px, 0px); border-radius: 1px;"></div></div><div style="position: absolute; top: -1px; opacity: 0.25; animation: 1s linear 0s infinite normal none running opacity-100-25-3-12;"><div style="position: absolute; width: 6px; height: 3px; background: rgb(0, 0, 0); box-shadow: rgba(0, 0, 0, 0.1) 0px 0px 1px; transform-origin: left center; transform: rotate(90deg) translate(5px, 0px); border-radius: 1px;"></div></div><div style="position: absolute; top: -1px; opacity: 0.25; animation: 1s linear 0s infinite normal none running opacity-100-25-4-12;"><div style="position: absolute; width: 6px; height: 3px; background: rgb(0, 0, 0); box-shadow: rgba(0, 0, 0, 0.1) 0px 0px 1px; transform-origin: left center; transform: rotate(120deg) translate(5px, 0px); border-radius: 1px;"></div></div><div style="position: absolute; top: -1px; opacity: 0.25; animation: 1s linear 0s infinite normal none running opacity-100-25-5-12;"><div style="position: absolute; width: 6px; height: 3px; background: rgb(0, 0, 0); box-shadow: rgba(0, 0, 0, 0.1) 0px 0px 1px; transform-origin: left center; transform: rotate(150deg) translate(5px, 0px); border-radius: 1px;"></div></div><div style="position: absolute; top: -1px; opacity: 0.25; animation: 1s linear 0s infinite normal none running opacity-100-25-6-12;"><div style="position: absolute; width: 6px; height: 3px; background: rgb(0, 0, 0); box-shadow: rgba(0, 0, 0, 0.1) 0px 0px 1px; transform-origin: left center; transform: rotate(180deg) translate(5px, 0px); border-radius: 1px;"></div></div><div style="position: absolute; top: -1px; opacity: 0.25; animation: 1s linear 0s infinite normal none running opacity-100-25-7-12;"><div style="position: absolute; width: 6px; height: 3px; background: rgb(0, 0, 0); box-shadow: rgba(0, 0, 0, 0.1) 0px 0px 1px; transform-origin: left center; transform: rotate(210deg) translate(5px, 0px); border-radius: 1px;"></div></div><div style="position: absolute; top: -1px; opacity: 0.25; animation: 1s linear 0s infinite normal none running opacity-100-25-8-12;"><div style="position: absolute; width: 6px; height: 3px; background: rgb(0, 0, 0); box-shadow: rgba(0, 0, 0, 0.1) 0px 0px 1px; transform-origin: left center; transform: rotate(240deg) translate(5px, 0px); border-radius: 1px;"></div></div><div style="position: absolute; top: -1px; opacity: 0.25; animation: 1s linear 0s infinite normal none running opacity-100-25-9-12;"><div style="position: absolute; width: 6px; height: 3px; background: rgb(0, 0, 0); box-shadow: rgba(0, 0, 0, 0.1) 0px 0px 1px; transform-origin: left center; transform: rotate(270deg) translate(5px, 0px); border-radius: 1px;"></div></div><div style="position: absolute; top: -1px; opacity: 0.25; animation: 1s linear 0s infinite normal none running opacity-100-25-10-12;"><div style="position: absolute; width: 6px; height: 3px; background: rgb(0, 0, 0); box-shadow: rgba(0, 0, 0, 0.1) 0px 0px 1px; transform-origin: left center; transform: rotate(300deg) translate(5px, 0px); border-radius: 1px;"></div></div><div style="position: absolute; top: -1px; opacity: 0.25; animation: 1s linear 0s infinite normal none running opacity-100-25-11-12;"><div style="position: absolute; width: 6px; height: 3px; background: rgb(0, 0, 0); box-shadow: rgba(0, 0, 0, 0.1) 0px 0px 1px; transform-origin: left center; transform: rotate(330deg) translate(5px, 0px); border-radius: 1px;"></div></div></div></span>
                <!--Begin-->
                <div class="product-block clearfix">
                    <div class="row">
                        <!--HINH ANH col-md-6 col-sm-6 col-xs-12 product-image clearfix-->
                        <div class="col-md-6">
                            <div class="sp-loading" style="display: none;"><img src="/Images/sp-loading.gif" alt=""><br>LOADING IMAGES</div>
                            <div class="sp-wrap sp-non-touch" style="display: inline-block;">
                                <!-- ngRepeat: item in ProductImages --><!-- end ngRepeat: item in ProductImages -->
                                <div class="sp-large"><a href="\Content\NguoDungCssLayout\Uploads\shop292\images\@Model.AnhBia" ng-repeat="item in ProductImages" class="ng-scope .sp-current-big"><img style="width:370px;height:500px;" alt="@Model.TenSach" src="\Content\NguoDungCssLayout\Uploads\shop292\images\@Model.AnhBia"></a></div>
                            </div>
                        </div>

                        <div class="col-md-6">
                            <h2 class="ng-binding">@Model.TenSach</h2>
                            <!-- ngIf: IsTrackingInventory==false||AllowPurchaseWhenSoldOut==true || (IsTrackingInventory&&AllowPurchaseWhenSoldOut==false&&Quantity>0) --><div class="price ng-scope" ng-if="IsTrackingInventory==false||AllowPurchaseWhenSoldOut==true || (IsTrackingInventory&amp;&amp;AllowPurchaseWhenSoldOut==false&amp;&amp;Quantity>0)">
                                <!-- ngIf: IsPromotion==true -->
                                <!-- ngIf: IsPromotion==false --><div style="font-weight:bold;" ng-if="IsPromotion==false" class="ng-scope"><span class="price-new ng-binding">@(String.Format("{0:#,##0;(£#,##0.00);Nothing}", Model.GiaBan)) VNĐ</span></div><!-- end ngIf: IsPromotion==false -->
                                <span class="product-code ng-binding">MÃ SÁCH: @Model.MaSach </span><br />
                                <span class="product-code ng-binding">CHỦ ĐỀ: @Model.ChuDe </span><br />
                                <span class="product-code ng-binding">TÁC GIẢ: @Model.TacGia </span><br />
                                <span class="product-code ng-binding">NHÀ XUẤT BẢN: @Model.NhaXuatBan </span><br />
                                <span class="product-code ng-binding">SỐ LƯỢNG TỒN: @Model.SoLuongTon</span>
                                 
                            </div><!-- end ngIf: IsTrackingInventory==false||AllowPurchaseWhenSoldOut==true || (IsTrackingInventory&&AllowPurchaseWhenSoldOut==false&&Quantity>0) -->
                            <!-- ngRepeat: item in ProductOptions -->
                            <div class="quantity clearfix">
                                <label>Số lượng</label>
                                <div class="quantity-input">
                                    <input type="number" id="quantity" value="1" class="text ng-pristine ng-untouched ng-valid" ng-model="InputQuantity" ng-init="InputQuantity=1">
                                    
                                </div>
                            </div>          
                            <!--goi Ham cript--><!--ẩn nút thêm nếu soluongton ==0-->
                            @if(@Model.SoLuongTon!=0)
                            { <!-- nut THEM GIO HANG --><div style="width: 140px;" onclick="AddToCard()" class="button ng-scope" ng-if="IsTrackingInventory==false||AllowPurchaseWhenSoldOut==true || (IsTrackingInventory&amp;&amp;AllowPurchaseWhenSoldOut==false&amp;&amp;Quantity>0)">
                                     <!--HAM Truyen item vao Add cua cript-->
                                <a id="addToCart" class="btn btn-default"><i class="glyphicon glyphicon-shopping-cart"></i>Thêm Vào Giỏ</a>
                                                         
                                <!--<a href="javascript:void(0)" ng-click="addToCardBuy()" class="btn btn-primary"><i class="glyphicon glyphicon-ok"></i>Mua ngay</a>-->
                            </div>
                            }<!-- end ngIf: IsTrackingInventory==false||AllowPurchaseWhenSoldOut==true || (IsTrackingInventory&&AllowPurchaseWhenSoldOut==false&&Quantity>0) -->
                           

                            <div class="social">
                                <!-- AddThis Button BEGIN -->
                                <div class="addthis_toolbox addthis_default_style">
                                    <a class="addthis_button_facebook_like at300b" fb:like:layout="button_count"><div class="fb-like fb_iframe_widget" data-layout="button_count" data-show_faces="false" data-share="true" data-action="like" data-width="90" data-height="25" data-font="arial" data-href="http://runecom50.runtime.vn/san-pham/a019.html" data-send="false" style="height: 25px;" fb-xfbml-state="rendered" fb-iframe-plugin-query="action=like&amp;app_id=227481454296289&amp;container_width=0&amp;font=arial&amp;height=25&amp;href=http%3A%2F%2Frunecom50.runtime.vn%2Fsan-pham%2Fa019.html&amp;layout=button_count&amp;locale=en_US&amp;sdk=joey&amp;send=false&amp;share=true&amp;show_faces=false&amp;width=90"><span style="vertical-align: bottom; width: 108px; height: 20px;"><iframe name="f3d0748cd6f8b34" width="90px" height="25px" frameborder="0" allowtransparency="true" allowfullscreen="true" scrolling="no" allow="encrypted-media" title="fb:like Facebook Social Plugin" src="https://www.facebook.com/v2.6/plugins/like.php?action=like&amp;app_id=227481454296289&amp;channel=https%3A%2F%2Fstaticxx.facebook.com%2Fconnect%2Fxd_arbiter.php%3Fversion%3D44%23cb%3Dfbd4256f6dcf7c%26domain%3Drunecom50.runtime.vn%26origin%3Dhttp%253A%252F%252Frunecom50.runtime.vn%252Ff6ecec0082c1c%26relation%3Dparent.parent&amp;container_width=0&amp;font=arial&amp;height=25&amp;href=http%3A%2F%2Frunecom50.runtime.vn%2Fsan-pham%2Fa019.html&amp;layout=button_count&amp;locale=en_US&amp;sdk=joey&amp;send=false&amp;share=true&amp;show_faces=false&amp;width=90" style="border: none; visibility: visible; width: 108px; height: 20px;" class=""></iframe></span></div></a>
                                    <a class="addthis_button_google_plusone at300b" g:plusone:size="medium"><div class="google_plusone_iframe_widget" style="width: 90px; height: 25px;"><span><div id="___plusone_0" style="position: absolute; width: 450px; left: -10000px;"><iframe ng-non-bindable="" frameborder="0" hspace="0" marginheight="0" marginwidth="0" scrolling="no" style="position:absolute;top:-10000px;width:450px;margin:0px;border-style:none" tabindex="0" vspace="0" width="100%" id="I0_1559476137967" name="I0_1559476137967" src="https://apis.google.com/u/0/se/0/_/+1/fastbutton?usegapi=1&amp;size=medium&amp;hl=en-US&amp;origin=http%3A%2F%2Frunecom50.runtime.vn&amp;url=http%3A%2F%2Frunecom50.runtime.vn%2Fsan-pham%2Fa019.html&amp;gsrc=3p&amp;ic=1&amp;jsh=m%3B%2F_%2Fscs%2Fapps-static%2F_%2Fjs%2Fk%3Doz.gapi.vi.qR4pPSSMk9M.O%2Fam%3DwQE%2Fd%3D1%2Frs%3DAGLTcCNNEK7rVIr4VFoH4mIg2pxfYX6bfw%2Fm%3D__features__#_methods=onPlusOne%2C_ready%2C_close%2C_open%2C_resizeMe%2C_renderstart%2Concircled%2Cdrefresh%2Cerefresh&amp;id=I0_1559476137967&amp;_gfid=I0_1559476137967&amp;parent=http%3A%2F%2Frunecom50.runtime.vn&amp;pfname=&amp;rpctoken=19776548" data-gapiattached="true"></iframe></div><g:plusone size="medium" lang="null" href="http://runecom50.runtime.vn/san-pham/a019.html" callback="_at_plusonecallback" data-gapiscan="true" data-onload="true" data-gapistub="true"></g:plusone></span></div></a>
                                    <a class="addthis_counter addthis_pill_style  addthis_nonzero" href="#" style="display: inline-block;" tabindex="0">

                                        <div class="atclear"></div>
                                </div>
                                <script type="text/javascript" src="/scripts/addthis/addthis_widget.js#pubid=ra-5334d6387b03b532"></script>
                                <!-- AddThis Button END -->
                            </div>

                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>
    <!--row mô tả-->
    <div style="" class="row">
        <h1 style="    width: 1150px;" class="title"><span></span></h1>
        <div style="word-wrap: break-word; color:black; "><b>@Model.MoTa</b></div>
        <br />
    </div>
   
    <br />


    <!--cung chu de -->
    @*<div class="row">*@
        <div class="col-md-12">
            <h1 style=" display: inline-block;margin-left: 422px;" class="title"><span>sản phẩm cùng thể loại!</span></h1>
            <!--SAN PHAM-->

            <div style="width:100%;" class="product-block product-grid clearfix">
                @foreach (var item in model)
                {
                    if (item.TrangThai == true && item.MaSach != Model.MaSach)
                    {
                        <div style="width:20%;" class="col-md-3 col-sm-3 col-xs-6 product-resize product-item-box">

                            <div class="product-item">
                                <div class="image image-resize">
                                    <a href="/Sach/ChiTietSanPham/@item.MaSach" title="@item.TenSach">
                                        <img src="\Content\NguoDungCssLayout\Uploads\shop292\images\@item.AnhBia" alt="@item.TenSach" class="img-responsive lazy-img" style="width:100%;height:310px;object-fit:cover;" />
                                    </a>
                                </div>
                                <div class="right-block">
                                    <h2 class="name">
                                        <a style="font-weight: bold;color: red;text-overflow: ellipsis;white-space: nowrap;width: 100%;overflow: hidden;display: block;" href="ChiTietSanPham/@item.MaSach" title="@item.TenSach">@item.TenSach</a>
                                    </h2>
                                    <div class="rating">
                                        <div class="rating-1">
                                            <span class="rating-img">
                                            </span>
                                        </div>
                                    </div>
                                    <div class="price">
                                        <span style="margin-left:30%;font-weight: bold;" class="price-new"> @(String.Format("{0:#,##0;(£#,##0.00);Nothing}", item.GiaBan)) VNĐ</span>
                                    </div>
                                    <div class="button">
                                        <a style="margin-left:30%;" class="btn btn-default btn-add-cart" href="/Sach/ChiTietSanPham/@item.MaSach">Mua</a>
                                        <!--<a class="btn btn-default btn-add-cart" href="javascript:void(0)" onclick="AddToCard(9535,1)">Mua</a>-->
                                    </div>
                                </div>
                            </div>

                        </div>
                    }
                }
            </div>
            <!---->

        </div>
    @*</div>*@
    
    <!---->

</div>

<script>
    function AddToCard() {//goi ham Addaction cua controllerGioHang-add nay cua MVC
        var link = "/giohang/add?masanpham=@(Model.MaSach)&soluong=" + document.getElementById("quantity").value;
        location.href = link;
    }
</script>


